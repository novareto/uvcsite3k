Do a functional doctest test on the app.
========================================

Let's first create an instance of Uvcsite at the top level:

    >>> from uvcsite.app import Uvcsite
    >>> from zope.component.hooks import setSite
    >>> root = getRootFolder()
    >>> root['app']
    <uvcsite.app.Uvcsite object at 0...>

    >>> setSite(root['app'])
    >>> from zope import component
    >>> from uvcsite.extranetmembership.interfaces import IUserManagement
    >>> component.getUtility(IUserManagement)
    <uvcsite.tests.fixtures.usermanagement.UserManagement object at...>

   Let's look if we have our authenticate infrastucture
----------------------------------------------------

   >>> from zope.component import getUtility
   >>> from zope.authentication.interfaces import IAuthentication

   >>> auth = getUtility(IAuthentication)
   >>> print(auth)
   <zope.pluggableauth.authentication.PluggableAuthentication object at ...>

   >>> for plugin in auth.getCredentialsPlugins():
   ...     print(plugin)
   ('cookies', <uvcsite.auth.cookies.CookiesCredentials object at 0...)
   ('Zope Realm Basic-Auth', <zope.pluggableauth.plugins.httpplugins.HTTPBasicAuthCredentialsPlugin object at 0...)

   >>> for plugin in auth.getAuthenticatorPlugins():
   ...     print(plugin)
   ('principals', <uvcsite.auth.handler.UVCAuthenticator object at 0...>) 


Only Authorzied people should get access
----------------------------------------

   >>> from zope.testbrowser.browser import Browser
   >>> browser = Browser(wsgi_app=wsgi_app())

This means if we open the index page. We get redirected
to the login page.


   >>> browser.open('http://localhost/app/index')
   >>> browser.url
   'http://localhost/app/@@login?camefrom=http%3A%2F%2Flocalhost%2Fapp%2Findex'

   >>> 'dolmen.authcookie' in browser.cookies
   False

Now we are at the Login Page

   >>> form = browser.getForm()
   >>> login = form.getControl(name='login')
   >>> login.value = "0101010001"

   >>> password = form.getControl(name='password')
   >>> password.value = "passwort"

   >>> came_from = form.getControl(name='camefrom')
   >>> came_from.value = 'http://localhost/app/index'

   >>> form.submit(name='action.log-in')

   >>> 'dolmen.authcookie' in browser.cookies
   True

   >>> print(browser.url)
   'http://localhost/app/index'

